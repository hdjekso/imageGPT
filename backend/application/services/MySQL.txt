create database moonlight;

use moonlight;

'CREATE TABLE `users` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `is_active` int(11) NOT NULL DEFAULT ''1'',
  `fname` varchar(255) NOT NULL DEFAULT '''',
  `lname` varchar(255) NOT NULL DEFAULT '''',
  `email` varchar(255) NOT NULL DEFAULT '''',
  `username` varchar(255) NOT NULL DEFAULT '''',
  `password` varchar(255) NOT NULL DEFAULT '''',
  `create_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `modify_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  UNIQUE KEY `uc_email` (`email`),
  UNIQUE KEY `uc_username` (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1'

CREATE TABLE `sessions` (
 `ID` int(11) NOT NULL AUTO_INCREMENT,
 `is_active` int(11) NOT NULL DEFAULT '1',
 `fk_user_ID` int(11) NOT NULL,
 `token` varchar(255) NOT NULL DEFAULT '',
 `create_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
 `modify_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
 PRIMARY KEY (`ID`),
 UNIQUE KEY `uc_token` (`token`),
 KEY `user_session` (`fk_user_ID`),
 CONSTRAINT `user_session` FOREIGN KEY (`fk_user_ID`) REFERENCES `users` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=latin1

'CREATE TABLE `messages` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `is_active` int(11) NOT NULL DEFAULT ''1'',
  `fk_user_ID` int(11) NOT NULL,
  `image_txt` varchar(255) NOT NULL DEFAULT '''',
  `users_inp` varchar(255) NOT NULL DEFAULT '''',
  `create_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `modify_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  KEY `user_message` (`fk_user_ID`),
  CONSTRAINT `user_message` FOREIGN KEY (`fk_user_ID`) REFERENCES `users` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=latin1'

'CREATE TABLE `inputs` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `is_active` int(11) NOT NULL DEFAULT ''1'',
  `fk_user_ID` int(11) NOT NULL,
  `fk_message_ID` int(11) NOT NULL,
  `input` varchar(255) NOT NULL DEFAULT '''',
  `response` varchar(255) NOT NULL DEFAULT '''',
  `create_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `modify_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ID`),
  KEY `message_input` (`fk_message_ID`),
  KEY `user_input` (`fk_user_ID`),
  CONSTRAINT `message_input` FOREIGN KEY (`fk_message_ID`) REFERENCES `messages` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `user_input` FOREIGN KEY (`fk_user_ID`) REFERENCES `users` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin1'